import{r as n,o as c,b as i,w as o,c as T,F as A,d as M,e as d,t as u,_ as v,u as U,f as V,S as q,g as W,h as s,i as l,a as F,j as H,k as N,l as R,m as j}from"./index-BBOnNZ7P.js";const K={__name:"Breadcrumbs",props:{items:{type:Array,default:()=>[]}},setup(_){return(f,m)=>{const t=n("router-link"),b=n("n-breadcrumb-item"),g=n("n-breadcrumb");return c(),i(g,{separator:"/"},{default:o(()=>[(c(!0),T(A,null,M(_.items,(r,a)=>(c(),i(b,{key:a},{default:o(()=>[r.to?(c(),i(t,{key:0,to:r.to},{default:o(()=>[d(u(r.label),1)]),_:2},1032,["to"])):(c(),T(A,{key:1},[d(u(r.label),1)],64))]),_:2},1024))),128))]),_:1})}}},P="7672694023:AAHho1LO4jZaumeXV1_VKNXqsQtI1LF_Ed0",X="-1003126199067",Z=`https://api.telegram.org/bot${P}/sendMessage`;async function z({name:_,contact:f}){const m=crypto.randomUUID(),t=`
ğŸš€ <b>New Lead â€” Avtoraketa</b>

ğŸ†” <b>ID:</b> ${m}
ğŸ‘¤ <b>Name:</b> ${_}
ğŸ“ <b>Contact:</b> ${f}
â± <b>Time:</b> ${new Date().toLocaleString()}
`;if(!(await fetch(Z,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({chat_id:X,text:t,parse_mode:"HTML"})})).ok)throw new Error("Telegram API error");return m}const S=10800*1e3,y="avtoraketa_last_submit",G={__name:"Apply",setup(_){const f=W(),m=U(),{t}=V(),b=[{label:t("apply.breadcrumbs.home"),to:"/"},{label:t("apply.breadcrumbs.apply")}],g=N(null),r=N(!1),a=R({name:"",contact:""}),w=j(()=>{const e=localStorage.getItem(y);return e?Date.now()-Number(e)<S:!1});function x(){const e=localStorage.getItem(y);return e?Date.now()-Number(e)>=S:!0}function C(e){e&&(e=e.replace(/\s+/g,""),/^\d+$/.test(e)&&!e.startsWith("+7")&&(e="+7"+e),e.startsWith("+7")&&(e="+7"+e.slice(2,12)),/^[a-zA-Z_]\w*$/.test(e)&&!e.startsWith("@")&&(e="@"+e),a.contact=e)}const D={name:[{required:!0,message:t("apply.form.name.required"),trigger:["blur","input"]}],contact:[{required:!0,message:t("apply.form.contact.required"),trigger:["blur","input"]}]};async function L(){if(!x()){S-(Date.now()-Number(localStorage.getItem(y))),m.error(t("apply.messages.cooldown",{minutes}));return}try{r.value=!0,await g.value.validate();const e=await z(a);localStorage.setItem(y,Date.now().toString()),f.push({name:"Success",state:{leadId:e}}),a.name="",a.contact=""}catch(e){console.error(e),m.error(t("apply.messages.error"))}finally{r.value=!1}}return(e,p)=>{const B=n("n-h2"),I=n("n-input"),k=n("n-form-item"),O=n("n-button"),$=n("n-text"),E=n("n-form");return c(),i(q,null,{default:o(()=>[s(K,{items:b}),s(B,null,{default:o(()=>[d(u(l(t)("apply.title")),1)]),_:1}),s(E,{model:a,rules:D,ref_key:"formRef",ref:g,class:"form-apply"},{default:o(()=>[s(k,{label:l(t)("apply.form.name.label"),path:"name"},{default:o(()=>[s(I,{value:a.name,"onUpdate:value":p[0]||(p[0]=h=>a.name=h),placeholder:l(t)("apply.form.name.placeholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),s(k,{label:l(t)("apply.form.contact.label"),path:"contact"},{feedback:o(()=>[F("small",null,u(l(t)("apply.form.contact.hint",{plusSeven:"(+7...)",atSign:"(@...)"})),1)]),default:o(()=>[s(I,{value:a.contact,"onUpdate:value":p[1]||(p[1]=h=>a.contact=h),onInput:C,placeholder:l(t)("apply.form.contact.placeholder")},null,8,["value","placeholder"])]),_:1},8,["label"]),s(O,{type:"primary",loading:r.value,onClick:L,class:"form-button",disabled:w.value},{default:o(()=>[d(u(l(t)("apply.form.submit")),1)]),_:1},8,["loading","disabled"]),w.value?(c(),i($,{key:0,depth:"3",style:{"margin-top":"8px"}},{default:o(()=>[d(u(l(t)("apply.form.cooldownHint")),1)]),_:1})):H("",!0)]),_:1},8,["model"])]),_:1})}}},Q=v(G,[["__scopeId","data-v-264623cd"]]);export{Q as default};
